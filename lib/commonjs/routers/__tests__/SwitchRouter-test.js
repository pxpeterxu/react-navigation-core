var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");var _objectSpread2=_interopRequireDefault(require("@babel/runtime/helpers/objectSpread"));var _react=_interopRequireDefault(require("react"));var _SwitchRouter=_interopRequireDefault(require("../SwitchRouter"));var _StackRouter=_interopRequireDefault(require("../StackRouter"));var NavigationActions=_interopRequireWildcard(require("../../NavigationActions"));var _routerTestHelper=require("./routerTestHelper");var _jsxFileName="/Users/peter/Code/react-navigation-core/src/routers/__tests__/SwitchRouter-test.js";describe('SwitchRouter',function(){it('resets the route when unfocusing a tab by default',function(){var _getRouterTestHelper=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter()),navigateTo=_getRouterTestHelper.navigateTo,getState=_getRouterTestHelper.getState;navigateTo('A2');expect(getState().routes[0].index).toEqual(1);expect(getState().routes[0].routes.length).toEqual(2);navigateTo('B');expect(getState().routes[0].index).toEqual(0);expect(getState().routes[0].routes.length).toEqual(1);});it('does not reset the route on unfocus if resetOnBlur is false',function(){var _getRouterTestHelper2=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter({resetOnBlur:false})),navigateTo=_getRouterTestHelper2.navigateTo,getState=_getRouterTestHelper2.getState;navigateTo('A2');expect(getState().routes[0].index).toEqual(1);expect(getState().routes[0].routes.length).toEqual(2);navigateTo('B');expect(getState().routes[0].index).toEqual(1);expect(getState().routes[0].routes.length).toEqual(2);});it('ignores back by default',function(){var _getRouterTestHelper3=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter()),jumpTo=_getRouterTestHelper3.jumpTo,back=_getRouterTestHelper3.back,getState=_getRouterTestHelper3.getState;jumpTo('B');expect(getState().index).toEqual(1);back();expect(getState().index).toEqual(1);});it('handles initialRoute backBehavior',function(){var _getRouterTestHelper4=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter({backBehavior:'initialRoute',initialRouteName:'B'})),jumpTo=_getRouterTestHelper4.jumpTo,back=_getRouterTestHelper4.back,getState=_getRouterTestHelper4.getState;expect(getState().routeKeyHistory).toBeUndefined();expect(getState().index).toEqual(1);jumpTo('C');expect(getState().index).toEqual(2);jumpTo('A');expect(getState().index).toEqual(0);back();expect(getState().index).toEqual(1);back();expect(getState().index).toEqual(1);});it('handles order backBehavior',function(){var _getRouterTestHelper5=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter({backBehavior:'order'})),navigateTo=_getRouterTestHelper5.navigateTo,back=_getRouterTestHelper5.back,getState=_getRouterTestHelper5.getState;expect(getState().routeKeyHistory).toBeUndefined();navigateTo('C');expect(getState().index).toEqual(2);back();expect(getState().index).toEqual(1);back();expect(getState().index).toEqual(0);back();expect(getState().index).toEqual(0);});it('handles history backBehavior',function(){var _getRouterTestHelper6=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter({backBehavior:'history'})),navigateTo=_getRouterTestHelper6.navigateTo,back=_getRouterTestHelper6.back,getState=_getRouterTestHelper6.getState;expect(getState().routeKeyHistory).toEqual(['A']);navigateTo('B');expect(getState().index).toEqual(1);expect(getState().routeKeyHistory).toEqual(['A','B']);navigateTo('A');expect(getState().index).toEqual(0);expect(getState().routeKeyHistory).toEqual(['B','A']);navigateTo('C');expect(getState().index).toEqual(2);expect(getState().routeKeyHistory).toEqual(['B','A','C']);navigateTo('A');expect(getState().index).toEqual(0);expect(getState().routeKeyHistory).toEqual(['B','C','A']);back();expect(getState().index).toEqual(2);expect(getState().routeKeyHistory).toEqual(['B','C']);back();expect(getState().index).toEqual(1);expect(getState().routeKeyHistory).toEqual(['B']);back();expect(getState().index).toEqual(1);expect(getState().routeKeyHistory).toEqual(['B']);});it('handles history backBehavior without popping routeKeyHistory when child handles action',function(){var _getRouterTestHelper7=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter({backBehavior:'history'})),navigateTo=_getRouterTestHelper7.navigateTo,back=_getRouterTestHelper7.back,getState=_getRouterTestHelper7.getState,getSubState=_getRouterTestHelper7.getSubState;expect(getState().routeKeyHistory).toEqual(['A']);navigateTo('B');expect(getState().index).toEqual(1);expect(getState().routeKeyHistory).toEqual(['A','B']);navigateTo('B2');expect(getState().index).toEqual(1);expect(getState().routeKeyHistory).toEqual(['A','B']);expect(getSubState(2).routeName).toEqual('B2');back();expect(getState().index).toEqual(1);expect(getState().routeKeyHistory).toEqual(['A','B']);expect(getSubState(2).routeName).toEqual('B1');});it('handles back and does not apply back action to inactive child',function(){var _getRouterTestHelper8=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter({backBehavior:'initialRoute',resetOnBlur:false})),navigateTo=_getRouterTestHelper8.navigateTo,back=_getRouterTestHelper8.back,getSubState=_getRouterTestHelper8.getSubState;expect(getSubState(1).routeName).toEqual('A');navigateTo('B');navigateTo('B2');expect(getSubState(1).routeName).toEqual('B');expect(getSubState(2).routeName).toEqual('B2');navigateTo('A');expect(getSubState(1).routeName).toEqual('A');back({key:null});expect(getSubState(1).routeName).toEqual('A');});it('handles pop and does not apply pop action to inactive child',function(){var _getRouterTestHelper9=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter({backBehavior:'initialRoute',resetOnBlur:false})),navigateTo=_getRouterTestHelper9.navigateTo,pop=_getRouterTestHelper9.pop,getSubState=_getRouterTestHelper9.getSubState;expect(getSubState(1).routeName).toEqual('A');navigateTo('B');navigateTo('B2');expect(getSubState(1).routeName).toEqual('B');expect(getSubState(2).routeName).toEqual('B2');navigateTo('A');expect(getSubState(1).routeName).toEqual('A');pop();expect(getSubState(1).routeName).toEqual('A');});it('handles popToTop and does not apply popToTop action to inactive child',function(){var _getRouterTestHelper10=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter({backBehavior:'initialRoute',resetOnBlur:false})),navigateTo=_getRouterTestHelper10.navigateTo,popToTop=_getRouterTestHelper10.popToTop,getSubState=_getRouterTestHelper10.getSubState;expect(getSubState(1).routeName).toEqual('A');navigateTo('B');navigateTo('B2');expect(getSubState(1).routeName).toEqual('B');expect(getSubState(2).routeName).toEqual('B2');navigateTo('A');expect(getSubState(1).routeName).toEqual('A');popToTop();expect(getSubState(1).routeName).toEqual('A');});it('handles back and does switch to inactive child with matching key',function(){var _getRouterTestHelper11=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter({backBehavior:'initialRoute',resetOnBlur:false})),navigateTo=_getRouterTestHelper11.navigateTo,back=_getRouterTestHelper11.back,getSubState=_getRouterTestHelper11.getSubState;expect(getSubState(1).routeName).toEqual('A');navigateTo('B');navigateTo('B2');expect(getSubState(1).routeName).toEqual('B');expect(getSubState(2).routeName).toEqual('B2');var b2Key=getSubState(2).key;navigateTo('A');expect(getSubState(1).routeName).toEqual('A');back(b2Key);expect(getSubState(1).routeName).toEqual('B');expect(getSubState(2).routeName).toEqual('B1');});it('handles nested actions',function(){var _getRouterTestHelper12=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter()),navigateTo=_getRouterTestHelper12.navigateTo,getSubState=_getRouterTestHelper12.getSubState;navigateTo('B',{action:{type:NavigationActions.NAVIGATE,routeName:'B2'}});expect(getSubState(1).routeName).toEqual('B');expect(getSubState(2).routeName).toEqual('B2');});it('handles nested actions and params simultaneously',function(){var _getRouterTestHelper13=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter()),navigateTo=_getRouterTestHelper13.navigateTo,getSubState=_getRouterTestHelper13.getSubState;var params1={foo:'bar'};var params2={bar:'baz'};navigateTo('B',{params:params1,action:{type:NavigationActions.NAVIGATE,routeName:'B2',params:params2}});expect(getSubState(1).routeName).toEqual('B');expect(getSubState(1).params).toEqual(params1);expect(getSubState(2).routeName).toEqual('B2');expect(getSubState(2).params).toEqual(params2);});it('order of handling navigate action is correct for nested switchrouters',function(){var Screen=function Screen(){return _react.default.createElement("div",{__source:{fileName:_jsxFileName,lineNumber:270}});};var NestedSwitch=function NestedSwitch(){return _react.default.createElement("div",{__source:{fileName:_jsxFileName,lineNumber:271}});};var OtherNestedSwitch=function OtherNestedSwitch(){return _react.default.createElement("div",{__source:{fileName:_jsxFileName,lineNumber:272}});};var nestedRouter=(0,_SwitchRouter.default)({Foo:Screen,Bar:Screen});var otherNestedRouter=(0,_SwitchRouter.default)({Foo:Screen});NestedSwitch.router=nestedRouter;OtherNestedSwitch.router=otherNestedRouter;var router=(0,_SwitchRouter.default)({NestedSwitch:NestedSwitch,OtherNestedSwitch:OtherNestedSwitch,Bar:Screen},{initialRouteName:'OtherNestedSwitch'});var _getRouterTestHelper14=(0,_routerTestHelper.getRouterTestHelper)(router),navigateTo=_getRouterTestHelper14.navigateTo,getSubState=_getRouterTestHelper14.getSubState;expect(getSubState(1).routeName).toEqual('OtherNestedSwitch');navigateTo('Bar');expect(getSubState(1).routeName).toEqual('Bar');navigateTo('NestedSwitch');navigateTo('Bar');expect(getSubState(1).routeName).toEqual('NestedSwitch');expect(getSubState(2).routeName).toEqual('Bar');});it('order of handling navigate action is correct for nested stackrouters',function(){var Screen=function Screen(){return _react.default.createElement("div",{__source:{fileName:_jsxFileName,lineNumber:305}});};var MainStack=function MainStack(){return _react.default.createElement("div",{__source:{fileName:_jsxFileName,lineNumber:306}});};var LoginStack=function LoginStack(){return _react.default.createElement("div",{__source:{fileName:_jsxFileName,lineNumber:307}});};MainStack.router=(0,_StackRouter.default)({Home:Screen,Profile:Screen});LoginStack.router=(0,_StackRouter.default)({Form:Screen,ForgotPassword:Screen});var router=(0,_SwitchRouter.default)({Home:Screen,Login:LoginStack,Main:MainStack},{initialRouteName:'Login'});var _getRouterTestHelper15=(0,_routerTestHelper.getRouterTestHelper)(router),navigateTo=_getRouterTestHelper15.navigateTo,getSubState=_getRouterTestHelper15.getSubState;expect(getSubState(1).routeName).toEqual('Login');navigateTo('Home');expect(getSubState(1).routeName).toEqual('Home');});it('does not error for a nested navigate action in an uninitialized history router',function(){var _getRouterTestHelper16=(0,_routerTestHelper.getRouterTestHelper)(getExampleRouter({backBehavior:'history'}),{skipInitializeState:true}),navigateTo=_getRouterTestHelper16.navigateTo,getSubState=_getRouterTestHelper16.getSubState;navigateTo('B',{action:NavigationActions.navigate({routeName:'B2'})});expect(getSubState(1).routeName).toEqual('B');expect(getSubState(2).routeName).toEqual('B2');});});var getExampleRouter=function getExampleRouter(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var PlainScreen=function PlainScreen(){return _react.default.createElement("div",{__source:{fileName:_jsxFileName,lineNumber:344}});};var StackA=function StackA(){return _react.default.createElement("div",{__source:{fileName:_jsxFileName,lineNumber:345}});};var StackB=function StackB(){return _react.default.createElement("div",{__source:{fileName:_jsxFileName,lineNumber:346}});};var StackC=function StackC(){return _react.default.createElement("div",{__source:{fileName:_jsxFileName,lineNumber:347}});};StackA.router=(0,_StackRouter.default)({A1:PlainScreen,A2:PlainScreen});StackB.router=(0,_StackRouter.default)({B1:PlainScreen,B2:PlainScreen});StackC.router=(0,_StackRouter.default)({C1:PlainScreen,C2:PlainScreen});var router=(0,_SwitchRouter.default)({A:{screen:StackA,path:''},B:{screen:StackB,path:'great/path'},C:{screen:StackC,path:'pathC'}},(0,_objectSpread2.default)({initialRouteName:'A'},config));return router;};
//# sourceMappingURL=SwitchRouter-test.js.map